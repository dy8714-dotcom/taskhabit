<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskHabit - ã‚¿ã‚¹ã‚¯ç®¡ç†ãƒ»ç¿’æ…£ãƒˆãƒ©ãƒƒã‚«ãƒ¼</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- Firebase SDK v9 (Modular) -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, doc, getDoc, setDoc, updateDoc, deleteDoc, onSnapshot, query, where } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚³ãƒ¼ãƒ—ã«å…¬é–‹
        window.firebase = { initializeApp };
        window.firebaseAuth = { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged };
        window.firebaseFirestore = { getFirestore, collection, doc, getDoc, setDoc, updateDoc, deleteDoc, onSnapshot, query, where };
        
        console.log('âœ… Firebase SDK loaded');
    </script>
</head>
<body>
    <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ -->
    <div id="loading" class="loading-screen">
        <div class="spinner"></div>
        <p>èª­ã¿è¾¼ã¿ä¸­...</p>
    </div>

    <!-- ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                <div class="app-icon">ğŸ“Š</div>
                <h1>TaskHabit</h1>
                <p class="subtitle">ã‚¿ã‚¹ã‚¯ç®¡ç†ãƒ»ç¿’æ…£ãƒˆãƒ©ãƒƒã‚«ãƒ¼</p>
            </div>
            
            <div class="login-content">
                <button id="googleLoginBtn" class="google-login-btn">
                    <svg width="18" height="18" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
                        <path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/>
                        <path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/>
                        <path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/>
                        <path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/>
                    </svg>
                    Google ã§ãƒ­ã‚°ã‚¤ãƒ³
                </button>
                
                <div style="margin-top: 20px; font-size: 14px; color: #666;">
                    <p>â€» Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ç°¡å˜ãƒ­ã‚°ã‚¤ãƒ³</p>
                    <p>â€» PCãƒ»ã‚¹ãƒãƒ›é–“ã§è‡ªå‹•åŒæœŸ</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªç”»é¢ -->
    <div id="appScreen" class="app-screen" style="display: none;">
        <header class="app-header">
            <div class="header-left">
                <h1>ğŸ“Š TaskHabit</h1>
                <div id="currentDate"></div>
            </div>
            <div class="header-right">
                <span>ğŸ‘¤ <span id="currentUser"></span></span>
                <button id="logoutBtn" class="btn-secondary">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
            </div>
        </header>

        <nav class="nav-tabs">
            <button data-view="dashboard" class="active">ğŸ“Š ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</button>
            <button data-view="tasks">ğŸ“ ã‚¿ã‚¹ã‚¯ãƒœãƒ¼ãƒ‰</button>
            <button data-view="habits">ğŸ¯ ç¿’æ…£ç®¡ç†</button>
            <button data-view="reports">ğŸ“ˆ ãƒ¬ãƒãƒ¼ãƒˆ</button>
            <button data-view="goals">ğŸ¯ ç›®æ¨™</button>
        </nav>

        <main class="main-content">
            <div id="dashboardView" class="view active">
                <div class="dashboard-cards">
                    <div class="card">
                        <h3>ğŸ“ ä»Šæ—¥ã®ã‚¿ã‚¹ã‚¯</h3>
                        <div class="card-value" id="todayTasks">0</div>
                    </div>
                    <div class="card">
                        <h3>ğŸ¯ ç¿’æ…£é”æˆç‡</h3>
                        <div class="card-value" id="habitProgress">0%</div>
                    </div>
                    <div class="card">
                        <h3>ğŸ”¥ æœ€é•·é€£ç¶šè¨˜éŒ²</h3>
                        <div class="card-value" id="longestStreak">0æ—¥</div>
                    </div>
                    <div class="card">
                        <h3>â±ï¸ ä»Šæ—¥ã®ä½œæ¥­æ™‚é–“</h3>
                        <div class="card-value" id="todayWorkTime">0h 0m</div>
                    </div>
                </div>
                <div class="dashboard-sections">
                    <section>
                        <h2>ä»Šæ—¥ã®ç¿’æ…£</h2>
                        <div id="todayHabits"></div>
                    </section>
                    <section>
                        <h2>ä»Šæ—¥ã®ã‚¿ã‚¹ã‚¯</h2>
                        <div id="todayTasksList"></div>
                    </section>
                </div>
            </div>

            <div id="tasksView" class="view" style="display: none;">
                <div class="view-header">
                    <h2>ğŸ“ ã‚¿ã‚¹ã‚¯ãƒœãƒ¼ãƒ‰</h2>
                    <button id="addTaskBtn" class="btn-primary">+ ã‚¿ã‚¹ã‚¯è¿½åŠ </button>
                </div>
                <div class="kanban-board">
                    <div class="kanban-column">
                        <h3>æœªç€æ‰‹</h3>
                        <div id="todoTasks"></div>
                    </div>
                    <div class="kanban-column">
                        <h3>é€²è¡Œä¸­</h3>
                        <div id="inProgressTasks"></div>
                    </div>
                    <div class="kanban-column">
                        <h3>å®Œäº†</h3>
                        <div id="doneTasks"></div>
                    </div>
                </div>
            </div>

            <div id="habitsView" class="view" style="display: none;">
                <div class="view-header">
                    <h2>ğŸ¯ ç¿’æ…£ç®¡ç†</h2>
                    <button id="addHabitBtn" class="btn-primary">+ ç¿’æ…£è¿½åŠ </button>
                </div>
                <div id="habitsList"></div>
            </div>

            <div id="reportsView" class="view" style="display: none;">
                <h2>ğŸ“ˆ ãƒ¬ãƒãƒ¼ãƒˆ</h2>
                <div id="reportsContent"></div>
            </div>

            <div id="goalsView" class="view" style="display: none;">
                <div class="view-header">
                    <h2>ğŸ¯ ç›®æ¨™</h2>
                    <button id="addGoalBtn" class="btn-primary">+ ç›®æ¨™è¿½åŠ </button>
                </div>
                <div id="goalsList"></div>
            </div>
        </main>

        <div class="data-controls">
            <button id="exportBtn" class="btn-secondary">ğŸ“¥ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
            <button id="importBtn" class="btn-secondary">ğŸ“¤ ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</button>
        </div>
    </div>

    <!-- ãƒ¢ãƒ¼ãƒ€ãƒ«é¡ -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>ã‚¿ã‚¹ã‚¯</h2>
            <input type="text" id="taskTitle" placeholder="ã‚¿ã‚¹ã‚¯å">
            <textarea id="taskDescription" placeholder="èª¬æ˜"></textarea>
            <select id="taskPriority">
                <option value="low">ä½</option>
                <option value="medium">ä¸­</option>
                <option value="high">é«˜</option>
            </select>
            <input type="date" id="taskDeadline">
            <select id="taskType">
                <option value="general">ä¸€èˆ¬</option>
                <option value="habit">ç¿’æ…£</option>
            </select>
            <div class="modal-actions">
                <button id="saveTaskBtn" class="btn-primary">ä¿å­˜</button>
                <button id="cancelTaskBtn" class="btn-secondary">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
            </div>
        </div>
    </div>

    <div id="habitModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>ç¿’æ…£</h2>
            <input type="text" id="habitName" placeholder="ç¿’æ…£å">
            <textarea id="habitDescription" placeholder="èª¬æ˜"></textarea>
            <select id="habitFrequency">
                <option value="daily">æ¯æ—¥</option>
                <option value="weekly">é€±1å›</option>
            </select>
            <div class="modal-actions">
                <button id="saveHabitBtn" class="btn-primary">ä¿å­˜</button>
                <button id="cancelHabitBtn" class="btn-secondary">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
            </div>
        </div>
    </div>

    <div id="habitLogModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>ç¿’æ…£ã‚’è¨˜éŒ²</h2>
            <input type="time" id="habitLogTime">
            <textarea id="habitLogNote" placeholder="ãƒ¡ãƒ¢"></textarea>
            <div class="modal-actions">
                <button id="saveHabitLogBtn" class="btn-primary">è¨˜éŒ²</button>
                <button id="cancelHabitLogBtn" class="btn-secondary">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
            </div>
        </div>
    </div>

    <div id="goalModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>ç›®æ¨™</h2>
            <input type="text" id="goalName" placeholder="ç›®æ¨™å">
            <textarea id="goalDescription" placeholder="èª¬æ˜"></textarea>
            <input type="date" id="goalDeadline">
            <div class="modal-actions">
                <button id="saveGoalBtn" class="btn-primary">ä¿å­˜</button>
                <button id="cancelGoalBtn" class="btn-secondary">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
            </div>
        </div>
    </div>

    <div id="importModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</h2>
            <input type="file" id="importFile" accept=".json">
            <div class="modal-actions">
                <button id="confirmImportBtn" class="btn-primary">ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</button>
                <button id="cancelImportBtn" class="btn-secondary">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
            </div>
        </div>
    </div>

    <div id="notification" class="notification"></div>

    <script src="app.js" type="module"></script>
</body>
</html>
